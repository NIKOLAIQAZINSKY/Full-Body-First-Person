This code is now available for free
